<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2018"><meta name="DC.rights.owner" content="(C) Copyright 2018"><meta name="DC.Type" content="concept"><meta name="DC.Relation" scheme="URI" content="../topics/impala_query_options.html"><meta name="prodname" content="Impala"><meta name="prodname" content="Impala"><meta name="version" content="Impala 3.0.x"><meta name="version" content="Impala 3.0.x"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="schedule_random_replica"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>SCHEDULE_RANDOM_REPLICA Query Option (Impala 2.5 or higher only)</title></head><body id="schedule_random_replica"><main role="main"><article role="article" aria-labelledby="ariaid-title1">

  <h1 class="title topictitle1" id="ariaid-title1">SCHEDULE_RANDOM_REPLICA Query Option (<span class="keyword">Impala 2.5</span> or higher only)</h1>



  <div class="body conbody">

    <p class="p">

    </p>

    <p class="p">
      The <code class="ph codeph">SCHEDULE_RANDOM_REPLICA</code> query option fine-tunes the algorithm for deciding which host
      processes each HDFS data block. It only applies to tables and partitions that are not enabled
      for the HDFS caching feature.
    </p>

    <p class="p">
        <strong class="ph b">Type:</strong> Boolean; recognized values are 1 and 0, or <code class="ph codeph">true</code> and <code class="ph codeph">false</code>;
        any other value interpreted as <code class="ph codeph">false</code>
      </p>

    <p class="p">
        <strong class="ph b">Default:</strong> <code class="ph codeph">false</code>
      </p>

    <p class="p">
        <strong class="ph b">Added in:</strong> <span class="keyword">Impala 2.5.0</span>
      </p>

    <p class="p">
        <strong class="ph b">Usage notes:</strong>
      </p>

    <p class="p">
      In the presence of HDFS cached replicas, Impala randomizes
      which host processes each cached data block.
      To ensure that HDFS data blocks are cached on more
      than one host, use the <code class="ph codeph">WITH REPLICATION</code> clause along with
      the <code class="ph codeph">CACHED IN</code> clause in a
      <code class="ph codeph">CREATE TABLE</code> or <code class="ph codeph">ALTER TABLE</code> statement.
      Specify a replication value greater than or equal to the HDFS block replication factor.
    </p>

    <p class="p">
      The <code class="ph codeph">SCHEDULE_RANDOM_REPLICA</code> query option applies to tables and partitions
      that <em class="ph i">do not</em> use HDFS caching.
      By default, Impala estimates how much work each host has done for
      the query, and selects the host that has the lowest workload.
      This algorithm is intended to reduce CPU hotspots arising when the
      same host is selected to process multiple data blocks, but hotspots
      might still arise for some combinations of queries and data layout.
      When the <code class="ph codeph">SCHEDULE_RANDOM_REPLICA</code> option is enabled,
      Impala further randomizes the scheduling algorithm for non-HDFS cached blocks,
      which can further reduce the chance of CPU hotspots.
    </p>

    <p class="p">
      This query option works in conjunction with the work scheduling improvements
      in <span class="keyword">Impala 2.5</span> and higher. The scheduling improvements
      distribute the processing for cached HDFS data blocks to minimize hotspots:
      if a data block is cached on more than one host, Impala chooses which host
      to process each block based on which host has read the fewest bytes during
      the current query. Enable <code class="ph codeph">SCHEDULE_RANDOM_REPLICA</code> setting if CPU hotspots
      still persist because of cases where hosts are <span class="q">"tied"</span> in terms of
      the amount of work done; by default, Impala picks the first eligible host
      in this case.
    </p>

    <p class="p">
        <strong class="ph b">Related information:</strong>
      </p>
    <p class="p">
      <a class="xref" href="impala_perf_hdfs_caching.html#hdfs_caching">Using HDFS Caching with Impala (Impala 2.1 or higher only)</a>,
      <a class="xref" href="impala_scalability.html#scalability_hotspots">Avoiding CPU Hotspots for HDFS Cached Data</a>
      , <a class="xref" href="impala_replica_preference.html#replica_preference">REPLICA_PREFERENCE Query Option (Impala 2.7 or higher only)</a>
    </p>

  </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/impala_query_options.html">Query Options for the SET Statement</a></div></div></nav></article></main></body></html>
